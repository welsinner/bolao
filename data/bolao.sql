/*
INSERT INTO RESULTADOS
(RESU_NR_JOGO, RESU_TIME_A_NOME, RESU_TIME_B_NOME)
SELECT DISTINCT (PALP_NR_JOGO), PALP_TIME_A_NOME, PALP_TIME_B_NOME
FROM PALPITES
WHERE PALP_NR_JOGO <= 48
ORDER BY PALP_NR_JOGO;
*/

/*
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 5, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 1;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 2;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 7;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 3, RESU_TIME_B_GOLS = 3 WHERE RESU_NR_JOGO = 8;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 2, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 13;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 19;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 14;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 2, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 20;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 25;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 31;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 26;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 32;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 3, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 37;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 2 WHERE RESU_NR_JOGO = 38;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 2 WHERE RESU_NR_JOGO = 43;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 2 WHERE RESU_NR_JOGO = 44;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 3, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 3;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 9;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 4;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 10;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 1 WHERE RESU_NR_JOGO = 15;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 16;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 0, RESU_TIME_B_GOLS = 3 WHERE RESU_NR_JOGO = 21;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 2, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 27;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 2, RESU_TIME_B_GOLS = 0 WHERE RESU_NR_JOGO = 22;
UPDATE RESULTADOS SET RESU_TIME_A_GOLS = 1, RESU_TIME_B_GOLS = 2 WHERE RESU_NR_JOGO = 28;
*/

show search_path;
set search_path to public;
SELECT * FROM "RESULTADOS";

-- ACERTO PLACAR: 7 PONTOS --> 37 --> 47
UPDATE PALPITES SET PALP_PONTOS = 7
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS = R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS = R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
 );


-- ACERTA VENCEDOR A, MAS PLACAR DIFERENTE: 2 PONTOS --> 40 --> 56
UPDATE PALPITES SET PALP_PONTOS = 2
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS > P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS > R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS <> R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS <> R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA VENCEDOR A E GOLS DO VENCEDOR: 4 PONTOS --> 10
UPDATE PALPITES SET PALP_PONTOS = 4
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS > P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS > R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS = R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS <> R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA VENCEDOR A E GOLS DO PERDEDOR: 3 PONTOS --> 71 --> 91
UPDATE PALPITES SET PALP_PONTOS = 3
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS > P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS > R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS <> R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS = R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA VENCEDOR B, MAS PLACAR DIFERENTE: 2 PONTOS --> 30 --> 36
UPDATE PALPITES SET PALP_PONTOS = 2
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS < P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS < R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS <> R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS <> R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA VENCEDOR B E GOLS DO VENCEDOR: 4 PONTOS --> 8 --> 10
UPDATE PALPITES SET PALP_PONTOS = 4
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS < P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS < R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS <> R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS = R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA VENCEDOR B E GOLS DO PERDEDOR: 3 PONTOS --> 32 --> 34
UPDATE PALPITES SET PALP_PONTOS = 3
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS < P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS < R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS = R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS <> R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- ACERTA EMPATE E PLACAR DIFERENTE: 2 PONTOS --> 8 --> 10
UPDATE PALPITES SET PALP_PONTOS = 2
WHERE PALP_ID IN (
SELECT P.PALP_ID
FROM PALPITES P, RESULTADOS R
WHERE P.PALP_NR_JOGO = R.RESU_NR_JOGO
  AND P.PALP_TIME_A_GOLS = P.PALP_TIME_B_GOLS
  AND R.RESU_TIME_A_GOLS = R.RESU_TIME_B_GOLS
  AND P.PALP_TIME_A_GOLS <> R.RESU_TIME_A_GOLS
  AND P.PALP_TIME_B_GOLS <> R.RESU_TIME_B_GOLS
  AND P.PALP_NR_JOGO <= 48
);

-- 236/294 PALPITES COM PONTUACAO